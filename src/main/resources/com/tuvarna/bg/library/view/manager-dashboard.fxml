<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>

<StackPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.tuvarna.bg.library.controllers.ManagerDashboardController"
           styleClass="dashboard-container">

    <VBox styleClass="header" style="-fx-background-color: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 0);">
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-padding: 15 20;">
            <Label text="ðŸ“š" style="-fx-font-size: 24px;" />
            <Label text="Library Management System - Manager Dashboard" style="-fx-font-size: 18px; -fx-font-weight: bold;" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="userLabel" text="Welcome, Manager" style="-fx-text-fill: #667eea;" />
            <Button text="Logout" styleClass="secondary-button" onAction="#handleLogout" />
        </HBox>
    </VBox>

    <VBox style="-fx-translate-y: 60;">
        <TabPane styleClass="main-tab-pane">

            <Tab text="ðŸ“– Loans Management" closable="false">
                <VBox spacing="20" style="-fx-padding: 20;">

                    <VBox styleClass="form-container" spacing="15">
                        <Label text="Create New Loan" styleClass="form-title" />

                        <GridPane hgap="15" vgap="10">
                            <Label text="Customer:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="form-label" />
                            <ComboBox fx:id="customerCombo" promptText="Select customer" GridPane.columnIndex="1" GridPane.rowIndex="0" styleClass="text-field" />

                            <Label text="Book Copy:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="form-label" />
                            <ComboBox fx:id="copyCombo" promptText="Select available copy" GridPane.columnIndex="1" GridPane.rowIndex="1" styleClass="text-field" />

                            <Label text="Due Date:" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="form-label" />
                            <DatePicker fx:id="dueDatePicker" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                        </GridPane>

                        <HBox spacing="15" alignment="CENTER">
                            <Button text="Create Loan" styleClass="button" onAction="#createLoan" />
                            <Button text="Clear Form" styleClass="secondary-button" onAction="#clearLoanForm" />
                        </HBox>
                    </VBox>

                    <VBox styleClass="card" spacing="15">
                        <Label text="Active Loans" styleClass="card-title" />

                        <TableView fx:id="loansTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn text="ID" fx:id="loanIdColumn" />
                                <TableColumn text="Customer" fx:id="loanCustomerColumn" />
                                <TableColumn text="Book" fx:id="loanBookColumn" />
                                <TableColumn text="Borrowed Date" fx:id="loanBorrowedColumn" />
                                <TableColumn text="Due Date" fx:id="loanDueColumn" />
                                <TableColumn text="Status" fx:id="loanStatusColumn" />
                                <TableColumn text="Actions" fx:id="loanActionsColumn" />
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="ðŸ“‹ Reservations" closable="false">
                <VBox spacing="20" style="-fx-padding: 20;">
                    <VBox styleClass="card" spacing="15">
                        <Label text="Pending Reservations" styleClass="card-title" />

                        <TableView fx:id="reservationsTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn text="ID" fx:id="reservationIdColumn" />
                                <TableColumn text="Customer" fx:id="reservationCustomerColumn" />
                                <TableColumn text="Book" fx:id="reservationBookColumn" />
                                <TableColumn text="Created Date" fx:id="reservationCreatedColumn" />
                                <TableColumn text="Status" fx:id="reservationStatusColumn" />
                                <TableColumn text="Actions" fx:id="reservationActionsColumn" />
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>


            <Tab text="ðŸ‘¥ Customer Registration" closable="false">
                <VBox spacing="20" style="-fx-padding: 20;">

                    <VBox styleClass="form-container" spacing="15">
                        <Label text="Register New Customer" styleClass="form-title" />

                        <GridPane hgap="15" vgap="10">
                            <Label text="Username:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="form-label" />
                            <TextField fx:id="newUsernameField" promptText="Enter username" GridPane.columnIndex="1" GridPane.rowIndex="0" styleClass="text-field" />

                            <Label text="Password:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="form-label" />
                            <PasswordField fx:id="newPasswordField" promptText="Enter password" GridPane.columnIndex="1" GridPane.rowIndex="1" styleClass="text-field" />

                            <Label text="First Name:" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="form-label" />
                            <TextField fx:id="newFirstNameField" promptText="Enter first name" GridPane.columnIndex="1" GridPane.rowIndex="2" styleClass="text-field" />

                            <Label text="Last Name:" GridPane.columnIndex="0" GridPane.rowIndex="3" styleClass="form-label" />
                            <TextField fx:id="newLastNameField" promptText="Enter last name" GridPane.columnIndex="1" GridPane.rowIndex="3" styleClass="text-field" />

                            <Label text="Email:" GridPane.columnIndex="0" GridPane.rowIndex="4" styleClass="form-label" />
                            <TextField fx:id="newEmailField" promptText="Enter email" GridPane.columnIndex="1" GridPane.rowIndex="4" styleClass="text-field" />
                        </GridPane>

                        <HBox spacing="15" alignment="CENTER">
                            <Button text="Register Customer" styleClass="button" onAction="#registerCustomer" />
                            <Button text="Clear Form" styleClass="secondary-button" onAction="#clearCustomerForm" />
                        </HBox>
                    </VBox>
                </VBox>
            </Tab>

        </TabPane>
    </VBox>

</StackPane>